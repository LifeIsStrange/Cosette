[
["select * from emp where deptno = 10 intersect
select * from emp where deptno = 20
intersect
select * from emp where deptno = 30
", 
  "SELECT t5.EMPNO, t5.ENAME, t5.JOB, t5.MGR, t5.HIREDATE, t5.SAL, t5.COMM, t5.DEPTNO, t5.SLACKER
FROM (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, COUNT(*) AS $f9
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
GROUP BY EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER
UNION ALL
SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER, COUNT(*) AS $f9
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO = 20
GROUP BY EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER
UNION ALL
SELECT EMP1.EMPNO, EMP1.ENAME, EMP1.JOB, EMP1.MGR, EMP1.HIREDATE, EMP1.SAL, EMP1.COMM, EMP1.DEPTNO, EMP1.SLACKER, COUNT(*) AS $f9
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.DEPTNO = 30
GROUP BY EMP1.EMPNO, EMP1.ENAME, EMP1.JOB, EMP1.MGR, EMP1.HIREDATE, EMP1.SAL, EMP1.COMM, EMP1.DEPTNO, EMP1.SLACKER) AS t5
GROUP BY t5.EMPNO, t5.ENAME, t5.JOB, t5.MGR, t5.HIREDATE, t5.SAL, t5.COMM, t5.DEPTNO, t5.SLACKER
HAVING COUNT(*) = 3"],
["select z + x from (
  select x + y as z, x from (
    select * from (values (10, 1), (30, 3)) as t (x, y)
    where x + y > 50))", 
  "SELECT *
FROM (VALUES) AS t"],
["select * from (
select * from (values (10, 1), (30, 3)) as t (x, y)
union all
select * from (values (20, 2))
)
where x + y > 30", 
  "SELECT *
FROM (VALUES  (30, 3)) AS t"],
["select d.deptno from sales.dept d
order by cast(d.deptno as integer) offset 1", 
  "SELECT t0.DEPTNO, CAST(t0.DEPTNO AS INTEGER)
FROM (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
ORDER BY DEPT.DEPTNO
OFFSET 1 ROWS) AS t0"],
["select d.deptno from sales.dept d
order by cast(d.deptno as double) offset 1", 
  "SELECT t0.DEPTNO, CAST(t0.DEPTNO AS DOUBLE)
FROM (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
ORDER BY DEPT.DEPTNO
OFFSET 1 ROWS) AS t0"],
["select d.deptno from sales.dept d
order by cast(d.deptno as varchar(10)) offset 1", 
  "SELECT DEPT.DEPTNO, CAST(DEPT.DEPTNO AS VARCHAR(10))
FROM CATALOG.SALES.DEPT AS DEPT
ORDER BY CAST(DEPT.DEPTNO AS VARCHAR(10))
OFFSET 1 ROWS"],
["select *
from emp
where deptno=7
and empno = 10 and mgr is null and empno = 10", 
  "SELECT 10 AS EMPNO, EMP.ENAME, EMP.JOB, NULL AS MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, 7 AS DEPTNO, EMP.SLACKER
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 7 AND EMP.MGR IS NULL AND EMP.EMPNO = 10"],
["select * from emp where cast((empno + (10/2)) as int) = 13", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.EMPNO + 5 = 13"],
["select e1.ename from emp e1, dept d, emp e2 where e1.deptno = d.deptno and d.deptno = e2.deptno", 
  "SELECT EMP.ENAME
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO
INNER JOIN (CATALOG.SALES.DEPT AS DEPT0
INNER JOIN CATALOG.SALES.EMP AS EMP0 ON DEPT0.DEPTNO = EMP0.DEPTNO) ON EMP.DEPTNO = DEPT0.DEPTNO
INNER JOIN CATALOG.SALES.EMP AS EMP1 ON DEPT.DEPTNO = EMP1.DEPTNO"],
["${sql}", 
  "SELECT t3.ENAME, SUM(COUNT(EMP0.MGR))
FROM (SELECT EMP.ENAME, COUNT(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME
UNION ALL
SELECT EMP0.ENAME, COUNT(EMP0.MGR)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.ENAME) AS t3
GROUP BY t3.ENAME"],


["select count(*), sum(empno) from emp where false", 
  "SELECT *
FROM (VALUES  (0, NULL)) AS t"],
["${sql}", 
  "SELECT 4, 2 + 3, MAX(5)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY 4"],
["select a + b as x, b, a from (values (10, 1), (30, 7), (20, 3)) as t(a, b) where a - b < 21", 
  "SELECT *
FROM (VALUES  (11, 1, 10),
 (23, 3, 20)) AS t"],
["select * from emp where deptno = 10
except
select * from emp where deptno = 20
except
select * from emp where deptno = 30
", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
EXCEPT
SELECT *
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO = 20
EXCEPT
SELECT *
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.DEPTNO = 30"],
["select * from sales.emp
where EXISTS (
  select * from emp e where emp.deptno = e.deptno)
AND NOT EXISTS (
  select * from emp ee where ee.job = emp.job AND ee.sal=34)", 
  "SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN (SELECT EMP0.DEPTNO, TRUE AS $f1
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.DEPTNO) AS t2 ON EMP.DEPTNO = t2.DEPTNO
LEFT JOIN (SELECT EMP1.JOB, TRUE AS $f1
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.SAL = 34
GROUP BY EMP1.JOB) AS t7 ON EMP.JOB = t7.JOB
WHERE t7.$f1 IS NULL"],
["select * from (values (30, 3)) as t (x, y)
where x > 30
except
select * from (values (20, 2))
except
select * from (values (40, 4))", 
  "SELECT *
FROM (VALUES) AS t"],
["select a + b from (values (10, 1), (20, 3)) as t(a, b)", 
  "SELECT *
FROM (VALUES  (11),
 (23)) AS t"],
["select count(*) as c
from sales.emp
where deptno = 10
group by deptno, sal", 
  "SELECT COUNT(*) AS C
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
GROUP BY EMP.SAL"],
["select empno
from sales.emp
where exists (select deptno from sales.emp where empno < 20)
and emp.sal < 100", 
  "SELECT EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP,
(SELECT TRUE AS i
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20
GROUP BY TRUE) AS t1
WHERE EMP.SAL < 100"],
["select a, b from (values (10, 'x'), (20, 'y')) as t(a, b) where a < 15", 
  "SELECT *
FROM (VALUES  (10, 'x')) AS t"],
["select d.deptno from dept d where d.deptno=7 and d.deptno=8", 
  "SELECT t.DEPTNO
FROM (VALUES) AS t"],
["select x, sum(z), y from (
  select deptno as x, empno as y, sal as z, sal * 2 as zz
  from emp)
group by x, y", 
  "SELECT EMP.DEPTNO AS X, SUM(EMP.SAL), EMP.EMPNO AS Y
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.EMPNO, EMP.DEPTNO"],
["select e.ename from emp e, dept d where e.deptno = d.deptno", 
  "SELECT EMP.ENAME
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO"],
["select 2, deptno, job from emp as e1
union all
select 2, deptno, job from emp as e2", 
  "SELECT 2, t1.DEPTNO, t1.JOB
FROM (SELECT EMP.DEPTNO, EMP.JOB
FROM CATALOG.SALES.EMP AS EMP
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB
FROM CATALOG.SALES.EMP AS EMP0) AS t1"],
["select * from emp e1
  where e1.empno NOT IN
   (select empno from (select ename, empno, sal as r from emp) e2
    where r > 2 and e1.ename= e2.ename)", 
  "SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT t0.ENAME, COUNT(*) AS c, COUNT(t0.EMPNO) AS ck
FROM (SELECT EMP0.ENAME, EMP0.EMPNO, EMP0.SAL AS R
FROM CATALOG.SALES.EMP AS EMP0) AS t
WHERE t.R > 2
GROUP BY t0.ENAME) AS t3 ON EMP.ENAME = t3.ENAME
LEFT JOIN (SELECT t5.EMPNO, TRUE AS i, t5.ENAME
FROM (SELECT EMP1.ENAME, EMP1.EMPNO, EMP1.SAL AS R
FROM CATALOG.SALES.EMP AS EMP1) AS t4
WHERE t4.R > 2) AS t7 ON EMP.EMPNO = t7.EMPNO AND EMP.ENAME = t7.ENAME
WHERE NOT CASE WHEN t3.c = 0 THEN FALSE WHEN t7.i IS NOT NULL THEN TRUE WHEN t3.ck < t3.c THEN TRUE ELSE FALSE END"],
["select *
from (select (case when sal > 1000 then null else false end) as caseCol from emp)
where NOT(caseCol)", 
  "SELECT *
FROM (SELECT CASE WHEN EMP.SAL > 1000 THEN NULL ELSE FALSE END AS CASECOL
FROM CATALOG.SALES.EMP AS EMP) AS t
WHERE NOT t.CASECOL"],
["SELECT sal, SUM(comm), MIN(comm), SUM(DISTINCT sal)
FROM emp
GROUP BY sal", 
  "SELECT t0.SAL, SUM(SUM(EMP.COMM)), MIN(MIN(EMP.COMM)), SUM(t0.SAL)
FROM (SELECT EMP.SAL, SUM(EMP.COMM), MIN(EMP.COMM)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.SAL) AS t0
GROUP BY t0.SAL"],
["select sal from emp
where empno NOT IN (
  select deptno from dept
  where emp.job = dept.name)", 
  "SELECT EMP.SAL
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT DEPT.NAME, COUNT(*) AS c, COUNT(DEPT.DEPTNO) AS ck
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME) AS t0 ON EMP.JOB = t0.NAME
LEFT JOIN (SELECT DEPT0.DEPTNO, TRUE AS i, DEPT0.NAME
FROM CATALOG.SALES.DEPT AS DEPT0) AS t1 ON EMP.EMPNO = t1.DEPTNO AND EMP.JOB = t1.NAME
WHERE NOT CASE WHEN t0.c = 0 THEN FALSE WHEN t1.i IS NOT NULL THEN TRUE WHEN t0.ck < t0.c THEN TRUE ELSE FALSE END"],
["select * from (
select * from (
  select name, deptno from
  (
    select name, deptno, count(1) from dept group by name, deptno
    except all
    select name, deptno, 1 from dept
  ) subq
  except all
  select name, deptno from
  (
    select name, deptno, 1 from dept
    except all
    select name, deptno, count(1) from dept group by name, deptno
  ) subq2
) a
except all
select name, deptno from dept
) aa
", 
  "SELECT DEPT.NAME, DEPT.DEPTNO
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME, DEPT.DEPTNO
EXCEPT ALL
SELECT DEPT0.NAME, DEPT0.DEPTNO
FROM CATALOG.SALES.DEPT AS DEPT0
EXCEPT ALL
SELECT *
FROM (SELECT DEPT1.NAME, DEPT1.DEPTNO
FROM CATALOG.SALES.DEPT AS DEPT1
EXCEPT ALL
SELECT DEPT2.NAME, DEPT2.DEPTNO
FROM CATALOG.SALES.DEPT AS DEPT2
GROUP BY DEPT2.NAME, DEPT2.DEPTNO) AS t9
EXCEPT ALL
SELECT DEPT3.NAME, DEPT3.DEPTNO
FROM CATALOG.SALES.DEPT AS DEPT3"],
["select sal from emp where empno IN (
  select deptno from dept where emp.job = dept.name)", 
  "SELECT EMP.SAL
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.JOB = DEPT.NAME AND EMP.EMPNO = DEPT.DEPTNO"],
["select count(1) from emp where cast(null as integer) = 1", 
  "SELECT COUNT(*)
FROM (VALUES) AS t"],
["select deptno, count(distinct ename), count(distinct job)
 from sales.emp group by deptno", 
  "SELECT EMP.DEPTNO, COUNT(EMP.ENAME), COUNT(EMP.JOB)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO"],
["select * from dept where exists (
  select * from emp
  where emp.deptno = dept.deptno
  and emp.sal > 100)", 
  "SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
INNER JOIN (SELECT EMP.DEPTNO AS DEPTNO9, TRUE AS $f0
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.SAL > 100) AS t0 ON DEPT.DEPTNO = t0.DEPTNO9"],
["select * from emp e1
  where e1.empno > ALL (select deptno from dept)", 
  "SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER
FROM CATALOG.SALES.EMP AS EMP,
(SELECT MAX(DEPT.DEPTNO) AS m, COUNT(*) AS c, COUNT(DEPT.DEPTNO) AS d
FROM CATALOG.SALES.DEPT AS DEPT) AS t0
WHERE NOT CASE WHEN t0.c = 0 THEN FALSE WHEN EMP.EMPNO <= t0.m IS TRUE THEN TRUE WHEN t0.c > t0.d THEN NULL ELSE EMP.EMPNO <= t0.m END"],
["select ename from (
  select ename, deptno, sal + 1 as salPlus from emp) as e
where deptno in (
  select deptno from emp where sal + 1 = e.salPlus)", 
  "SELECT t.ENAME
FROM (SELECT EMP.ENAME, EMP.DEPTNO, EMP.SAL + 1 AS SALPLUS
FROM CATALOG.SALES.EMP AS EMP) AS t
INNER JOIN (SELECT t1.DEPTNO, t1.$f9
FROM (SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER, EMP0.SAL + 1 AS $f9
FROM CATALOG.SALES.EMP AS EMP0) AS t0
WHERE t0.SAL + 1 = t0.$f9
GROUP BY t1.DEPTNO, t1.$f9) AS t3 ON t.SALPLUS = t3.$f9 AND t.DEPTNO = t3.DEPTNO"],
["select empno
from sales.emp
where (empno, deptno) in (
  select empno, deptno from sales.emp where empno < 20)
or emp.sal < 100", 
  "SELECT EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT EMP0.EMPNO, EMP0.DEPTNO, TRUE AS i
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20) AS t1 ON EMP.EMPNO = t1.EMPNO AND EMP.DEPTNO = t1.DEPTNO
WHERE t1.i IS NOT NULL OR EMP.SAL < 100"],
["select ename, sal, deptno from (  select ename, sal, deptno  from emp  where sal > 5000)group by rollup(ename, sal, deptno)", 
  "SELECT t1.ENAME, t1.SAL, t1.DEPTNO
FROM (SELECT EMP.ENAME, EMP.SAL, EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME, EMP.SAL, EMP.DEPTNO
HAVING EMP.SAL > 5000) AS t1
GROUP BY t1.ENAME, t1.SAL, t1.DEPTNO"],
["select * from (values (1,2)) where 1 + 2 > 3 + CAST(NULL AS INTEGER)", 
  "SELECT *
FROM (VALUES  (1, 2)) AS t
WHERE 1 + 2 > 3 + NULL"],
["select mgr from emp where mgr=10", 
  "SELECT CAST(10 AS INTEGER) AS MGR
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.MGR = 10"],
["select * from emp
where sal = 4
or empno NOT IN (select deptno from dept)", 
  "SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT DEPT.DEPTNO, TRUE AS i
FROM CATALOG.SALES.DEPT AS DEPT) AS t0 ON EMP.EMPNO = t0.DEPTNO
WHERE EMP.SAL = 4 OR NOT CASE WHEN t0.i IS NOT NULL THEN TRUE ELSE FALSE END"],
["select * from sales.emp
where EXISTS (
  select * from emp e where emp.deptno = e.deptno)", 
  "SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN (SELECT EMP0.DEPTNO, TRUE AS $f1
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.DEPTNO) AS t2 ON EMP.DEPTNO = t2.DEPTNO"],
["${sql}", 
  "SELECT t3.ENAME, SUM(COUNT(*))
FROM (SELECT EMP.ENAME, COUNT(*)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME
UNION ALL
SELECT EMP0.ENAME, COUNT(*)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.ENAME) AS t3
GROUP BY t3.ENAME"],
["select e1.ename from emp e1, dept d, emp e2 where e1.deptno = d.deptno and d.deptno = e2.deptno", 
  "SELECT EMP.ENAME
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO
INNER JOIN CATALOG.SALES.EMP AS EMP0 ON DEPT.DEPTNO = EMP0.DEPTNO"],
["select *
from struct.t t1
where c0 in (
  select f1.c0 from struct.t t2)", 
  "SELECT T."K0", T."C1", T."F1"."A0", T."F2"."A0", T."F0"."C0", T."F1"."C0", T."F0"."C1", T."F1"."C2", T."F2"."C3"
FROM CATALOG.STRUCT.T AS T
INNER JOIN (SELECT T0."F1"."C0" AS C0
FROM CATALOG.STRUCT.T AS T0
GROUP BY T0."F1"."C0") AS t0 ON T."F0"."C0" = t0.C0"],
["select * from (values (false),(true)) as q (col1) where not(col1)", 
  "SELECT *
FROM (VALUES  (FALSE),
 (TRUE)) AS t
WHERE NOT t.EXPR$0"],
["select * from emp e1
  where e1.empno > SOME (select deptno from dept)", 
  "SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER
FROM CATALOG.SALES.EMP AS EMP,
(SELECT MIN(DEPT.DEPTNO) AS m, COUNT(*) AS c, COUNT(DEPT.DEPTNO) AS d
FROM CATALOG.SALES.DEPT AS DEPT) AS t0
WHERE CASE WHEN t0.c = 0 THEN FALSE WHEN EMP.EMPNO > t0.m IS TRUE THEN TRUE WHEN t0.c > t0.d THEN NULL ELSE EMP.EMPNO > t0.m END"],
["select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from emp e inner join bonus b on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end", 
  "SELECT COUNT(*), t.CASE
FROM (SELECT EMP.ENAME, CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END AS CASE
FROM CATALOG.SALES.EMP AS EMP) AS t
INNER JOIN (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t0 ON t.ENAME = t0.ENAME
GROUP BY t.CASE"],
["select e.job,
  min(sal) as min_sal, min(e.deptno) as min_deptno,
  sum(sal) + 1 as sum_sal_plus, max(sal) as max_sal,
  sum(sal) as sum_sal_2, count(sal) as count_sal,
  count(mgr) as count_mgr
from sales.emp as e
join sales.dept as d on e.job = d.name
group by e.job,d.name", 
  "SELECT t.JOB, t.MIN_SAL, t.MIN_DEPTNO, CAST(t.SUM_SAL_2 * t0.$f1 AS INTEGER) + 1 AS SUM_SAL_PLUS, t.MAX_SAL, CAST(t.SUM_SAL_2 * t0.$f1 AS INTEGER) AS SUM_SAL_2, t.COUNT_SAL * t0.$f1 AS COUNT_SAL, t.COUNT_MGR * t0.$f1 AS COUNT_MGR
FROM (SELECT EMP.JOB, MIN(EMP.SAL) AS MIN_SAL, MIN(EMP.DEPTNO) AS MIN_DEPTNO, SUM(EMP.SAL) AS SUM_SAL_2, MAX(EMP.SAL) AS MAX_SAL, COUNT(*) AS COUNT_SAL, COUNT(EMP.MGR) AS COUNT_MGR
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.JOB) AS t
INNER JOIN (SELECT DEPT.NAME, COUNT(*) AS $f1
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME) AS t0 ON t.JOB = t0.NAME"],
["${sql}", 
  "SELECT t1.ENAME, AVG(t1.EMPNO)
FROM (SELECT EMP.ENAME, EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP
UNION ALL
SELECT EMP0.ENAME, EMP0.EMPNO
FROM CATALOG.SALES.EMP AS EMP0) AS t1
GROUP BY t1.ENAME"],
["select count(*), case when e.sal < 11 then -1 * e.sal else e.sal end
from emp e full outer join bonus b on e.ename = b.ename
group by case when e.sal < 11 then -1 * e.sal else e.sal end", 
  "SELECT COUNT(*), t.CASE
FROM (SELECT EMP.ENAME, CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END AS CASE
FROM CATALOG.SALES.EMP AS EMP) AS t
FULL JOIN (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t0 ON t.ENAME = t0.ENAME
GROUP BY t.CASE"],
["select * from (
  select upper(substring(x FROM 1 FOR 2) || substring(x FROM 3)) as u,
      substring(x FROM 1 FOR 1) as s
  from (
    select 'table' as x from (values (true))
    union
    select 'view' from (values (true))
    union
    select 'foreign table' from (values (true))
  )
) where u = 'TABLE'", 
  "SELECT 'TABLE        ' AS U, 't' AS S
FROM (VALUES  (TRUE)) AS t"],
["select *
from emp
where deptno=7 and deptno=8
and empno = 10 and mgr is null and empno = 10", 
  "SELECT 10 AS EMPNO, t.ENAME, t.JOB, NULL AS MGR, t.HIREDATE, t.SAL, t.COMM, t.DEPTNO, t.SLACKER
FROM (VALUES) AS t"],
["select * from (
  select *
  from (
    select cast(null as integer) as n
    from emp)
  where n is null and n is null)
where n is null", 
  "SELECT NULL AS N
FROM CATALOG.SALES.EMP AS EMP"],
["${sql}", 
  "SELECT t5.DEPTNO, SUM(COUNT(*))
FROM (SELECT EMP.DEPTNO, COUNT(*)
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
GROUP BY EMP.DEPTNO
UNION ALL
SELECT EMP0.DEPTNO, COUNT(*)
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO > 20
GROUP BY EMP0.DEPTNO) AS t5
GROUP BY t5.DEPTNO"],
["select empno from emp where empno>10 and empno<=10", 
  "SELECT t.EMPNO
FROM (VALUES) AS t"],
["${sql}", 
  "SELECT t3.DEPTNO, t3.JOB, SUM(SUM(EMP0.EMPNO)), SUM(COUNT(*)), MIN(MIN(EMP0.DEPTNO)), MAX(MAX(EMP0.EMPNO))
FROM (SELECT EMP.DEPTNO, EMP.JOB, SUM(EMP.EMPNO), COUNT(*), MIN(EMP.DEPTNO), MAX(EMP.EMPNO)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.JOB
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB, SUM(EMP0.EMPNO), COUNT(*), MIN(EMP0.DEPTNO), MAX(EMP0.EMPNO)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.DEPTNO, EMP0.JOB) AS t3
GROUP BY t3.DEPTNO, t3.JOB"],
["select e1.ename from emp e1, dept d, emp e2 where e1.deptno = d.deptno and e1.empno = e2.empno", 
  "SELECT EMP.ENAME
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO
INNER JOIN CATALOG.SALES.EMP AS EMP0 ON EMP.EMPNO = EMP0.EMPNO
INNER JOIN CATALOG.SALES.DEPT AS DEPT0 ON EMP.DEPTNO = DEPT0.DEPTNO
INNER JOIN CATALOG.SALES.EMP AS EMP1 ON EMP.EMPNO = EMP1.EMPNO"],
["select 1 from emp inner join dept on emp.deptno=dept.deptno", 
  "SELECT 1
FROM CATALOG.SALES.EMP AS EMP,
CATALOG.SALES.DEPT AS DEPT
WHERE EMP.DEPTNO = DEPT.DEPTNO"],
["select d.name,
  sum(sal) as sum_sal, count(*) as c
from sales.emp as e
join (select distinct name from sales.dept) as d
  on e.job = d.name
group by d.name", 
  "SELECT t0.NAME, t.SUM_SAL, t.C
FROM (SELECT EMP.JOB, SUM(EMP.SAL) AS SUM_SAL, COUNT(*) AS C
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.JOB) AS t
INNER JOIN (SELECT DEPT.NAME
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME) AS t0 ON t.JOB = t0.NAME"],
["select sal
from sales.emp
where empno IN (
  select deptno from dept where emp.job = dept.name)
AND empno IN (
  select empno from emp e where emp.ename = e.ename)", 
  "SELECT EMP.SAL
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.JOB = DEPT.NAME AND EMP.EMPNO = DEPT.DEPTNO
INNER JOIN (SELECT EMP0.EMPNO, EMP0.ENAME
FROM CATALOG.SALES.EMP AS EMP0) AS t ON EMP.ENAME = t.ENAME AND EMP.EMPNO = t.EMPNO"],
["select count(*), case when e.sal < 11 then -1 * e.sal else e.sal end
from bonus b left outer join emp e on e.ename = b.ename
group by case when e.sal < 11 then -1 * e.sal else e.sal end", 
  "SELECT COUNT(*), t0.CASE
FROM (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t
LEFT JOIN (SELECT EMP.ENAME, CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END AS CASE
FROM CATALOG.SALES.EMP AS EMP) AS t0 ON t.ENAME = t0.ENAME
GROUP BY t0.CASE"],
["select empno
from sales.emp
where exists (select deptno from sales.emp where empno < 20)", 
  "SELECT EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP,
(SELECT TRUE AS i
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20
GROUP BY TRUE) AS t1"],
["${sql}", 
  "SELECT EMP.DEPTNO, MAX(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO"],
["${sql}", 
  "SELECT t3.ENAME, SUM(SUM(EMP0.EMPNO)), SUM(COUNT(*)), MIN(MIN(EMP0.DEPTNO)), MAX(MAX(EMP0.EMPNO))
FROM (SELECT EMP.ENAME, SUM(EMP.EMPNO), COUNT(*), MIN(EMP.DEPTNO), MAX(EMP.EMPNO)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME
UNION ALL
SELECT EMP0.ENAME, SUM(EMP0.EMPNO), COUNT(*), MIN(EMP0.DEPTNO), MAX(EMP0.EMPNO)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.ENAME) AS t3
GROUP BY t3.ENAME"],
["select e1.ename, r
from (
  select ename,   rank() over(partition by  deptno order by sal) as r   from emp) e1
where r < 2", 
  "SELECT *
FROM (SELECT EMP.ENAME, RANK() OVER (PARTITION BY EMP.DEPTNO ORDER BY EMP.SAL RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS R
FROM CATALOG.SALES.EMP AS EMP) AS t
WHERE t.R < 2"],
["${sql}", 
  "SELECT t3.DEPTNO, t3.JOB, SUM(SUM(EMP0.MGR))
FROM (SELECT EMP.DEPTNO, EMP.JOB, SUM(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.JOB
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB, SUM(EMP0.MGR)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.DEPTNO, EMP0.JOB) AS t3
GROUP BY t3.DEPTNO, t3.JOB"],
["select name from (
  select *
  from dept
  where deptno = 10)
where deptno = 10
", 
  "SELECT DEPT.NAME
FROM CATALOG.SALES.DEPT AS DEPT
WHERE DEPT.DEPTNO = 10"],
["select deptno, job, count(distinct ename) from sales.emp group by rollup(deptno,job)", 
  "SELECT EMP.DEPTNO, EMP.JOB, COUNT(EMP.ENAME)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.JOB"],
["select deptno, job, count(distinct ename), sum(sal) from sales.emp group by rollup(deptno,job)", 
  "SELECT EMP.DEPTNO, EMP.JOB, COUNT(EMP.ENAME), CAST(MIN(SUM(EMP.SAL)) AS INTEGER)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.JOB"],
["select sal from (select * from emp e1 union all select * from emp e2)", 
  "SELECT EMP.SAL
FROM CATALOG.SALES.EMP AS EMP
UNION ALL
SELECT EMP0.SAL
FROM CATALOG.SALES.EMP AS EMP0"],
["select * from emp where deptno = 10
except
select * from (
  select * from emp where deptno = 20
  except
  select * from emp where deptno = 30)", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
EXCEPT
SELECT *
FROM (SELECT *
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO = 20
EXCEPT
SELECT *
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.DEPTNO = 30) AS t2"],
["select dname, c from (select name dname, count(*) as c from dept group by name) t where dname = 'Charlie'", 
  "SELECT t0.DNAME, COUNT(*) AS C
FROM (SELECT DEPT.NAME AS DNAME
FROM CATALOG.SALES.DEPT AS DEPT) AS t
WHERE t.DNAME = 'Charlie'
GROUP BY t0.DNAME"],
["select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from emp e full outer join bonus b on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end", 
  "SELECT COUNT(*), CASE WHEN t.< THEN 11 ELSE t.* END
FROM (SELECT EMP.ENAME, EMP.SAL < 11 AS <, -1 * EMP.SAL AS *
FROM CATALOG.SALES.EMP AS EMP) AS t
FULL JOIN (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t0 ON t.ENAME = t0.ENAME
GROUP BY CASE WHEN t.< THEN 11 ELSE t.* END"],
["select * from (
select * from emp where false)
join dept using (deptno)", 
  "SELECT *
FROM (VALUES) AS t"],
["select * from emp where false order by deptno", 
  "SELECT *
FROM (VALUES) AS t
ORDER BY t.DEPTNO"],
["SELECT sal, SUM(comm), MIN(DISTINCT comm), SUM(DISTINCT sal)
FROM emp
GROUP BY sal", 
  "SELECT t0.SAL, SUM(EMP.COMM), MIN(t2.EXPR$2), SUM(t6.SAL)
FROM (SELECT EMP.SAL, SUM(EMP.COMM)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.SAL) AS t0
INNER JOIN (SELECT t2.SAL, MIN(t2.EXPR$2)
FROM (SELECT EMP0.SAL, EMP0.COMM
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.SAL, EMP0.COMM) AS t2
GROUP BY t2.SAL) AS t3 ON t0.SAL IS NOT DISTINCT FROM t3.SAL
INNER JOIN (SELECT t6.SAL, SUM(t6.SAL)
FROM (SELECT EMP1.SAL
FROM CATALOG.SALES.EMP AS EMP1
GROUP BY EMP1.SAL) AS t6
GROUP BY t6.SAL) AS t7 ON t0.SAL IS NOT DISTINCT FROM t7.SAL"],

cycles
["select empno from emp where empno=10 and empno is null", 
  "SELECT t.EMPNO
FROM (VALUES) AS t"],
["${sql}", 
  "SELECT t3.DEPTNO, t3.JOB, SUM(COUNT(EMP0.MGR))
FROM (SELECT EMP.DEPTNO, EMP.JOB, COUNT(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.JOB
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB, COUNT(EMP0.MGR)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.DEPTNO, EMP0.JOB) AS t3
GROUP BY t3.DEPTNO, t3.JOB"],
["select count(*),
 case when e.sal < 11 then -1 * e.sal else e.sal end
from emp e right outer join bonus b on e.ename = b.ename
group by case when e.sal < 11 then -1 * e.sal else e.sal end", 
  "SELECT COUNT(*), t.CASE
FROM (SELECT EMP.ENAME, CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END AS CASE
FROM CATALOG.SALES.EMP AS EMP) AS t
RIGHT JOIN (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t0 ON t.ENAME = t0.ENAME
GROUP BY t.CASE"],
["select count(*), case when e.sal < 11 then -1 * e.sal else e.sal end
from bonus b right outer join emp e on e.ename = b.ename
group by case when e.sal < 11 then -1 * e.sal else e.sal end", 
  "SELECT COUNT(*), t0.CASE
FROM (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t
RIGHT JOIN (SELECT EMP.ENAME, CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END AS CASE
FROM CATALOG.SALES.EMP AS EMP) AS t0 ON t.ENAME = t0.ENAME
GROUP BY t0.CASE"],
["select dept.* from dept right join (
  select distinct deptno from emp
  where sal > 100) using (deptno)", 
  "SELECT DEPT.DEPTNO, DEPT.NAME
FROM CATALOG.SALES.DEPT AS DEPT
RIGHT JOIN (SELECT EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.SAL > 100
GROUP BY EMP.DEPTNO) AS t1 ON DEPT.DEPTNO = t1.DEPTNO"],
["select 1 from sales.dept d full outer join sales.emp e on d.deptno = e.deptno where e.sal > 100", 
  "SELECT 1
FROM CATALOG.SALES.DEPT AS DEPT
RIGHT JOIN (SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.SAL > 100) AS t ON DEPT.DEPTNO = t.DEPTNO"],
["select dept1.c1 from (
  select dept.name as c1, count(*) as c2
  from dept where dept.name > 'b' group by dept.name) dept1
where dept1.c1 > 'c' and (dept1.c2 > 30 or dept1.c1 < 'z')", 
  "SELECT t1.C1
FROM (SELECT DEPT.NAME AS C1
FROM CATALOG.SALES.DEPT AS DEPT
WHERE DEPT.NAME > 'b') AS t0
WHERE t0.C1 > 'c'
GROUP BY t1.C1
HAVING COUNT(*) > 30 OR t1.C1 < 'z'"],
["select count(*) from sales.emp join sales.dept on job = name", 
  "SELECT SUM(COUNT(*) * COUNT(*))
FROM (SELECT EMP.JOB, COUNT(*)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.JOB) AS t
INNER JOIN (SELECT DEPT.NAME, COUNT(*)
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME) AS t0 ON t.JOB = t0.NAME"],
["select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from emp e left outer join bonus b on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end", 
  "SELECT COUNT(*), t.CASE
FROM (SELECT EMP.ENAME, CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END AS CASE
FROM CATALOG.SALES.EMP AS EMP) AS t
LEFT JOIN (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t0 ON t.ENAME = t0.ENAME
GROUP BY t.CASE"],
["select a.name from dept a
union all
select b.name from dept b
order by name limit 10", 
  "SELECT *
FROM (SELECT DEPT.NAME
FROM CATALOG.SALES.DEPT AS DEPT
ORDER BY DEPT.NAME
FETCH NEXT 10 ROWS ONLY
UNION ALL
SELECT DEPT0.NAME
FROM CATALOG.SALES.DEPT AS DEPT0
ORDER BY DEPT0.NAME
FETCH NEXT 10 ROWS ONLY) AS t5
ORDER BY t5.NAME
FETCH NEXT 10 ROWS ONLY"],
["select empno from emp
where empno=10 and not(empno=10)", 
  "SELECT t.EMPNO
FROM (VALUES) AS t"],
["select e.* from (select ename, trim(job), sal * 2, deptno from emp) e, dept d where e.deptno = d.deptno", 
  "SELECT t.ENAME, TRIM(BOTH ' ' FROM EMP.JOB), EMP.SAL * 2, t.DEPTNO
FROM (SELECT EMP.ENAME, TRIM(BOTH ' ' FROM EMP.JOB), EMP.SAL * 2, EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO) AS t
INNER JOIN CATALOG.SALES.DEPT AS DEPT0 ON t.DEPTNO = DEPT0.DEPTNO"],
["select e1.ename, r
from (
  select ename,
  rank() over(partition by  deptno order by sal) + 1 as r   from emp) e1
where r < 2", 
  "SELECT *
FROM (SELECT EMP.ENAME, (RANK() OVER (PARTITION BY EMP.DEPTNO ORDER BY EMP.SAL RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW)) + 1 AS R
FROM CATALOG.SALES.EMP AS EMP) AS t
WHERE t.R < 2"],
["SELECT CASE WHEN 1=2 THEN cast((values(1)) as integer) ELSE 2 end from (values(1))", 
  "SELECT CAST(2 AS INTEGER)
FROM (VALUES  (1)) AS t
LEFT JOIN (VALUES  (1)) AS t0 ON TRUE"],
["select sum(empno) from emp where false", 
  "SELECT SUM(t.EMPNO)
FROM (VALUES) AS t"],
["select * from sales.emp e left join (
select * from sales.dept d) using (deptno)
order by sal limit 10", 
  "SELECT *
FROM (SELECT *
FROM CATALOG.SALES.EMP AS EMP
ORDER BY EMP.SAL
FETCH NEXT 10 ROWS ONLY) AS t0
LEFT JOIN CATALOG.SALES.DEPT AS DEPT ON t0.DEPTNO = DEPT.DEPTNO
ORDER BY t0.SAL
FETCH NEXT 10 ROWS ONLY"],
["select * from sales.emp e right join (
select * from sales.dept d) using (deptno)
order by name", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
RIGHT JOIN (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
ORDER BY DEPT.NAME) AS t ON EMP.DEPTNO = t.DEPTNO
ORDER BY t.NAME"],
["select * from sales.emp left join (
select * from sales.dept) using (deptno)
order by sal, name limit 10", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO
ORDER BY EMP.SAL, DEPT.NAME
FETCH NEXT 10 ROWS ONLY"],
["select * from sales.emp e right join (
select * from sales.dept d) using (deptno)
order by name", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
RIGHT JOIN (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
ORDER BY DEPT.NAME) AS t ON EMP.DEPTNO = t.DEPTNO
ORDER BY t.NAME"],
["select * from sales.emp e right join (
select * from sales.dept d) using (deptno)
limit 10", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
RIGHT JOIN (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
FETCH NEXT 10 ROWS ONLY) AS t ON EMP.DEPTNO = t.DEPTNO
FETCH NEXT 10 ROWS ONLY"],
["select * from (
select * from (
  select name, deptno from dept
  union all
  select name, deptno from
  (
    select name, deptno, count(1) from dept group by name, deptno
    union all
    select name, deptno, count(1) from dept group by name, deptno
  ) subq
) a
union all
select name, deptno from dept
) aa
", 
  "SELECT DEPT.NAME, DEPT.DEPTNO
FROM CATALOG.SALES.DEPT AS DEPT
UNION ALL
SELECT DEPT0.NAME, DEPT0.DEPTNO
FROM CATALOG.SALES.DEPT AS DEPT0
GROUP BY DEPT0.NAME, DEPT0.DEPTNO
UNION ALL
SELECT DEPT1.NAME, DEPT1.DEPTNO
FROM CATALOG.SALES.DEPT AS DEPT1
GROUP BY DEPT1.NAME, DEPT1.DEPTNO
UNION ALL
SELECT DEPT2.NAME, DEPT2.DEPTNO
FROM CATALOG.SALES.DEPT AS DEPT2"],
["select dept.* from dept join (
  select distinct deptno from emp
  where sal > 100) using (deptno)", 
  "SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
INNER JOIN (SELECT EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.SAL > 100) AS t0 ON DEPT.DEPTNO = t0.DEPTNO"],
["select a + b as x, b, a from (values (10, 1), (30, 7)) as t(a, b) where a - b < 0", 
  "SELECT *
FROM (VALUES) AS t"],
["select empno + deptno from emp where sal = 10 * comm and upper(ename) = 'FOO'", 
  "SELECT t0.EMPNO + t0.DEPTNO
FROM (SELECT EMP.EMPNO, EMP.ENAME, EMP.SAL, EMP.COMM, EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP) AS t
WHERE t.SAL = 10 * t.COMM AND UPPER(t.ENAME) = 'FOO'"],
["SELECT deptno, SUM(comm), MIN(comm), SUM(DISTINCT sal)
FROM emp
GROUP BY deptno", 
  "SELECT t0.DEPTNO, SUM(MIN(EMP.COMM)), MIN(t0.EXPR$3), SUM(SUM(MIN(EMP.COMM)))
FROM (SELECT EMP.DEPTNO, EMP.SAL, SUM(EMP.COMM), MIN(EMP.COMM)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.SAL) AS t0
GROUP BY t0.DEPTNO"],
["select x, sum(z), y from (
  select deptno as x, empno as y, sal as z, sal * 2 as zz
  from emp)
group by rollup(x, y)", 
  "SELECT EMP.DEPTNO AS X, SUM(EMP.SAL), EMP.EMPNO AS Y
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.EMPNO, EMP.DEPTNO"],
["select * from (
  select * from dept where dept.deptno in (
    select emp.deptno from emp))R
where R.deptno <=10", 
  "SELECT *
FROM (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
WHERE DEPT.DEPTNO <= 10) AS t
INNER JOIN (SELECT EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP) AS t0 ON t.DEPTNO = t0.DEPTNO"]
["${sql}", 
  "SELECT t3.ENAME, MIN(MIN(EMP0.EMPNO))
FROM (SELECT EMP.ENAME, MIN(EMP.EMPNO)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME
UNION ALL
SELECT EMP0.ENAME, MIN(EMP0.EMPNO)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.ENAME) AS t3
GROUP BY t3.ENAME"],
["${sql}", 
  "SELECT t3.DEPTNO, t3.JOB, SUM(SUM(3))
FROM (SELECT EMP.DEPTNO, EMP.JOB, SUM(2)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.JOB
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB, SUM(3)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.DEPTNO, EMP0.JOB) AS t3
GROUP BY t3.DEPTNO, t3.JOB"],
["${sql}", 
  "SELECT DEPT.DEPTNO, DEPT.NAME, COUNT(*) AS C
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.DEPTNO, DEPT.NAME
HAVING DEPT.NAME = 'Charlie'"],
["${sql}", 
  "SELECT t0.DNAME, t0.DDEPTNO, COUNT(*) AS C
FROM (SELECT DEPT.NAME AS DNAME, DEPT.DEPTNO AS DDEPTNO
FROM CATALOG.SALES.DEPT AS DEPT) AS t
WHERE t.DNAME = 'Charlie'
GROUP BY t0.DNAME, t0.DDEPTNO"],
["select name, stddev_pop(deptno), avg(deptno), stddev_samp(deptno),var_pop(deptno), var_samp(deptno)
from sales.dept group by name", 
  "SELECT DEPT.NAME, CAST(POWER((SUM(DEPT.DEPTNO * DEPT.DEPTNO) - SUM(DEPT.DEPTNO) * SUM(DEPT.DEPTNO) / COUNT(*)) / COUNT(*), 0.5) AS INTEGER), CAST(SUM(DEPT.DEPTNO) / COUNT(*) AS INTEGER), CAST(POWER((SUM(DEPT.DEPTNO * DEPT.DEPTNO) - SUM(DEPT.DEPTNO) * SUM(DEPT.DEPTNO) / COUNT(*)) / CASE WHEN COUNT(*) = 1 THEN NULL ELSE COUNT(*) - 1 END, 0.5) AS INTEGER), CAST((SUM(DEPT.DEPTNO * DEPT.DEPTNO) - SUM(DEPT.DEPTNO) * SUM(DEPT.DEPTNO) / COUNT(*)) / COUNT(*) AS INTEGER), CAST((SUM(DEPT.DEPTNO * DEPT.DEPTNO) - SUM(DEPT.DEPTNO) * SUM(DEPT.DEPTNO) / COUNT(*)) / CASE WHEN COUNT(*) = 1 THEN NULL ELSE COUNT(*) - 1 END AS INTEGER)
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME"],
["${sql}", 
  "SELECT EMP.DEPTNO, MAX(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO"],
["select * from emp where deptno = 10
intersect
select * from emp where deptno = 20
intersect all
select * from emp where deptno = 30
", 
  "SELECT t3.EMPNO, t3.ENAME, t3.JOB, t3.MGR, t3.HIREDATE, t3.SAL, t3.COMM, t3.DEPTNO, t3.SLACKER
FROM (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, COUNT(*) AS $f9
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
GROUP BY EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER
UNION ALL
SELECT EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER, COUNT(*) AS $f9
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO = 20
GROUP BY EMP0.EMPNO, EMP0.ENAME, EMP0.JOB, EMP0.MGR, EMP0.HIREDATE, EMP0.SAL, EMP0.COMM, EMP0.DEPTNO, EMP0.SLACKER) AS t3
GROUP BY t3.EMPNO, t3.ENAME, t3.JOB, t3.MGR, t3.HIREDATE, t3.SAL, t3.COMM, t3.DEPTNO, t3.SLACKER
HAVING COUNT(*) = 2
INTERSECT ALL
SELECT *
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.DEPTNO = 30"],
["select * from (
select * from emp where false)
right join dept using (deptno)", 
  "SELECT *
FROM (VALUES) AS t
RIGHT JOIN CATALOG.SALES.DEPT AS DEPT ON t.DEPTNO = DEPT.DEPTNO"],
["${sql}", 
  "SELECT t3.DEPTNO, t3.JOB, MAX(MAX(EMP0.MGR))
FROM (SELECT EMP.DEPTNO, EMP.JOB, MAX(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.JOB
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB, MAX(EMP0.MGR)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.DEPTNO, EMP0.JOB) AS t3
GROUP BY t3.DEPTNO, t3.JOB"],
["select p1 is not distinct from p0 from (values (2, cast(null as integer))) as t(p0, p1)", 
  "SELECT FALSE
FROM (VALUES  (0)) AS t"],
["select r1.sal from emp r1, (select * from emp e1 union all select * from emp e2) r2", 
  "SELECT t.SAL
FROM (SELECT *
FROM CATALOG.SALES.EMP AS EMP,
CATALOG.SALES.EMP AS EMP0
UNION ALL
SELECT *
FROM CATALOG.SALES.EMP AS EMP1,
CATALOG.SALES.EMP AS EMP2) AS t"],
["select 1 from sales.dept d full outer join sales.emp e on d.deptno = e.deptno where d.name = 'Charlie' and e.sal > 100", 
  "SELECT 1
FROM (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
WHERE DEPT.NAME = 'Charlie') AS t
INNER JOIN (SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.SAL > 100) AS t0 ON t.DEPTNO = t0.DEPTNO"],
["${sql}", 
  "SELECT t1.DEPTNO, t1.JOB, AVG(t1.EMPNO)
FROM (SELECT EMP.DEPTNO, EMP.JOB, EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB, EMP0.EMPNO
FROM CATALOG.SALES.EMP AS EMP0) AS t1
GROUP BY t1.DEPTNO, t1.JOB"],
["select sal
from emp
where case when sal = 1000 then null else 1 end is null
OR case when sal = 2000 then null else 1 end is null", 
  "SELECT EMP.SAL
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.SAL = 1000 OR EMP.SAL = 2000"],

cycles
["select name, max(name), avg(deptno), min(name) from sales.dept group by name", 
  "SELECT DEPT.NAME, MAX(DEPT.NAME), CAST(SUM(DEPT.DEPTNO) / COUNT(*) AS INTEGER), MIN(DEPT.NAME)
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME"],
["select * from emp where deptno = 10
union all
select * from emp where deptno = 20
union all
select * from emp where deptno = 30
", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
UNION ALL
SELECT *
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO = 20
UNION ALL
SELECT *
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.DEPTNO = 30"],
["select cast(d.name as varchar(128)), cast(e.empno as integer) from dept as d inner join emp as e on cast(d.deptno as integer) = cast(e.deptno as integer) where cast(e.job as varchar(1)) = 'Manager'", 
  "SELECT CAST(t2.NAME AS VARCHAR(128)), t2.EMPNO
FROM (SELECT t.DEPTNO, t.NAME, t0.EMPNO, t0.ENAME, t0.JOB, t0.MGR, t0.HIREDATE, t0.SAL, t0.COMM, t0.DEPTNO AS DEPTNO1, t0.SLACKER
FROM (SELECT DEPT.DEPTNO, DEPT.NAME, DEPT.DEPTNO AS DEPTNO0
FROM CATALOG.SALES.DEPT AS DEPT) AS t
INNER JOIN (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, EMP.DEPTNO AS DEPTNO0
FROM CATALOG.SALES.EMP AS EMP) AS t0 ON t.DEPTNO0 = t0.DEPTNO0) AS t1
WHERE CAST(t1.JOB AS VARCHAR(1)) = 'Manager'"],
["select 1 from sales.dept d left outer join sales.emp e on d.deptno = e.deptno where e.sal > 100", 
  "SELECT 1
FROM CATALOG.SALES.DEPT AS DEPT
INNER JOIN (SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.SAL > 100) AS t ON DEPT.DEPTNO = t.DEPTNO"],
["${sql}", 
  "SELECT SUM(SUM(EMP0.MGR))
FROM (SELECT SUM(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
UNION ALL
SELECT SUM(EMP0.MGR)
FROM CATALOG.SALES.EMP AS EMP0) AS t3"],
["select * from (values (30, 3)) as t (x, y)
except
select * from (values (20, 2)) as t (x, y) where x > 30
except
select * from (values (40, 4))
except
select * from (values (50, 5)) as t (x, y) where x > 50", 
  "SELECT *
FROM (VALUES  (30, 3)) AS t
EXCEPT
SELECT *
FROM (VALUES  (40, 4)) AS t0"],
["select e.job,d.name
from (select * from sales.emp where empno = 10) as e
join sales.dept as d on e.job = d.name
group by e.job,d.name", 
  "SELECT *
FROM (SELECT EMP.JOB
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.EMPNO = 10
GROUP BY EMP.JOB) AS t0
INNER JOIN (SELECT DEPT.NAME
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME) AS t1 ON t0.JOB = t1.NAME"],
["select e.job,d.name
from (select * from sales.emp where empno = 10) as e
join sales.dept as d on e.job = d.name
and e.deptno + e.empno = d.deptno + 5
group by e.job,d.name", 
  "SELECT t1.JOB, t3.NAME
FROM (SELECT EMP.JOB, EMP.DEPTNO + EMP.EMPNO AS $f9
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.EMPNO = 10
GROUP BY EMP.JOB, EMP.DEPTNO + EMP.EMPNO) AS t1
INNER JOIN (SELECT DEPT.NAME, DEPT.DEPTNO + 5 AS $f2
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME, DEPT.DEPTNO + 5) AS t3 ON t1.JOB = t3.NAME AND t1.$f9 = t3.$f2
GROUP BY t1.JOB, t3.NAME"],
["select e.empno,d.deptno
from (select * from sales.emp where empno = 10) as e
join sales.dept as d on e.empno < d.deptno
group by e.empno,d.deptno", 
  "SELECT t.EMPNO, DEPT.DEPTNO AS DEPTNO0
FROM (SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.EMPNO = 10) AS t
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON t.EMPNO < DEPT.DEPTNO
GROUP BY t.EMPNO, DEPT.DEPTNO"],
["select e.deptno
from sales.emp as e join sales.dept as d on e.deptno = d.deptno
group by e.deptno", 
  "SELECT t.DEPTNO
FROM (SELECT EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO) AS t
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON t.DEPTNO = DEPT.DEPTNO"],
["select e.deptno, d.deptno
from sales.emp as e join sales.dept as d on e.deptno = d.deptno
group by e.deptno, d.deptno", 
  "SELECT t.DEPTNO, DEPT.DEPTNO AS DEPTNO0
FROM (SELECT EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO) AS t
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON t.DEPTNO = DEPT.DEPTNO"],
["select a.name
from dept a
left join dept b on b.deptno > 10
right join dept c on b.deptno > 10
", 
  "SELECT t3.NAME
FROM (SELECT DEPT.DEPTNO, DEPT.NAME, CAST(t1.DEPTNO AS INTEGER) AS DEPTNO0, CAST(t1.NAME AS VARCHAR(10)) AS NAME0, CAST(t1.DEPTNO AS INTEGER) > 10 AS $f4
FROM CATALOG.SALES.DEPT AS DEPT,
(SELECT t0.DEPTNO, t0.NAME, t0.DEPTNO > 10 AS $f2
FROM (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT0
WHERE DEPT0.DEPTNO > 10) AS t
WHERE t.DEPTNO > 10) AS t1) AS t3
RIGHT JOIN CATALOG.SALES.DEPT AS DEPT1 ON TRUE"],
["select 1+2, d.deptno+(3+4), (5+6)+d.deptno, cast(null as integer), coalesce(2,null), row(7+8) from dept d inner join emp e on d.deptno = e.deptno + (5-5) where d.deptno=(7+8) and d.deptno=(8+7) and d.deptno=coalesce(2,null)", 
  "SELECT 3, 22, 26, NULL, CAST(2 AS INTEGER), ROW(15)
FROM (VALUES) AS t"],
["${sql}", 
  "SELECT t3.ENAME, SUM(SUM(NULL))
FROM (SELECT EMP.ENAME, SUM(NULL)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME
UNION ALL
SELECT EMP0.ENAME, SUM(NULL)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.ENAME) AS t3
GROUP BY t3.ENAME"],
["select * from (
  select d.deptno, e.ename
  from emp as e
  join dept as d
  on e.deptno = d.deptno
  and d.deptno = 10)
where deptno = 10
", 
  "SELECT t.DEPTNO, EMP.ENAME
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
WHERE DEPT.DEPTNO = 10) AS t ON EMP.DEPTNO = t.DEPTNO"],
["select * from emp where deptno = 10
union distinct
select * from emp where deptno = 20
union
select * from emp where deptno = 30
", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
UNION
SELECT *
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO = 20
UNION
SELECT *
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.DEPTNO = 30"],
["select *
from dept left join emp using (deptno)
where emp.deptno is not null and emp.sal > 100", 
  "SELECT DEPT.DEPTNO, DEPT.NAME, CAST(t.EMPNO AS INTEGER) AS EMPNO, CAST(t.ENAME AS VARCHAR(20)) AS ENAME, CAST(t.JOB AS VARCHAR(10)) AS JOB, t.MGR, CAST(t.HIREDATE AS TIMESTAMP(0)) AS HIREDATE, CAST(t.SAL AS INTEGER) AS SAL, CAST(t.COMM AS INTEGER) AS COMM, CAST(t.DEPTNO AS INTEGER) AS DEPTNO0, CAST(t.SLACKER AS BOOLEAN) AS SLACKER
FROM CATALOG.SALES.DEPT AS DEPT
INNER JOIN (SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.SAL > 100) AS t ON DEPT.DEPTNO = t.DEPTNO"],
["select e.job,sum(sal)
from (select * from sales.emp where empno = 10) as e
join sales.dept as d on e.job = d.name
group by e.job,d.name", 
  "SELECT t0.JOB, CAST(SUM(EMP.SAL) * t1.$f1 AS INTEGER)
FROM (SELECT EMP.JOB, SUM(EMP.SAL)
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.EMPNO = 10
GROUP BY EMP.JOB) AS t0
INNER JOIN (SELECT DEPT.NAME, COUNT(*) AS $f1
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME) AS t1 ON t0.JOB = t1.NAME"],
["select empno
from sales.emp
where deptno in (select deptno from sales.emp where empno < 20)
or emp.sal < 100", 
  "SELECT EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT EMP0.DEPTNO, TRUE AS i
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20
GROUP BY EMP0.DEPTNO, TRUE) AS t2 ON EMP.DEPTNO = t2.DEPTNO
WHERE t2.i IS NOT NULL OR EMP.SAL < 100"],
["select count(1) from emp
where case deptno
  when 20 then 2
  when 10 then 1
  else 3 end = 1", 
  "SELECT COUNT(*)
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10"],
["select z + x from (
  select x + y as z, x from (
    select * from (values (10, 1), (30, 3)) as t (x, y)
    where x + y > 50))", 
  "SELECT t.X + t.Y + t.X
FROM (VALUES) AS t"],
["${sql}", 
  "SELECT EMP.DEPTNO, MAX(EMP.ENAME)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO"],
["select * from dept union select * from dept", 
  "SELECT t.DEPTNO, t.NAME
FROM (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
UNION ALL
SELECT *
FROM CATALOG.SALES.DEPT AS DEPT0) AS t
GROUP BY t.DEPTNO, t.NAME"],
["select e.ename from emp e, dept d where e.deptno = d.deptno and e.ename = 'foo'", 
  "SELECT t.ENAME
FROM (SELECT *
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO
WHERE EMP.ENAME = 'foo') AS t
INNER JOIN CATALOG.SALES.DEPT AS DEPT0 ON t.DEPTNO = DEPT0.DEPTNO"],
["select name from (
  select name, deptno, deptno - 10 as deptnoMinus from dept) as d
where deptno in (
  select deptno from emp where sal + 1 = d.deptnoMinus)", 
  "SELECT t.NAME
FROM (SELECT DEPT.NAME, DEPT.DEPTNO, DEPT.DEPTNO - 10 AS DEPTNOMINUS
FROM CATALOG.SALES.DEPT AS DEPT) AS t
INNER JOIN (SELECT t1.DEPTNO, t1.$f9
FROM (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, EMP.SAL + 1 AS $f9
FROM CATALOG.SALES.EMP AS EMP) AS t0
WHERE t0.SAL + 1 = t0.$f9
GROUP BY t1.DEPTNO, t1.$f9) AS t3 ON t.DEPTNOMINUS = t3.$f9 AND t.DEPTNO = t3.DEPTNO"],
["select deptno, job from (select deptno, job from emp as e1 group by deptno,job  union all select deptno, job from emp as e2 group by deptno,job) group by deptno,job", 
  "SELECT t1.DEPTNO, t1.JOB
FROM (SELECT EMP.DEPTNO, EMP.JOB
FROM CATALOG.SALES.EMP AS EMP
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB
FROM CATALOG.SALES.EMP AS EMP0) AS t1
GROUP BY t1.DEPTNO, t1.JOB"],
["${sql}", 
  "SELECT t3.ENAME, SUM(SUM(EMP0.MGR))
FROM (SELECT EMP.ENAME, SUM(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME
UNION ALL
SELECT EMP0.ENAME, SUM(EMP0.MGR)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.ENAME) AS t3
GROUP BY t3.ENAME"],
["select sum(empno) from emp where false group by deptno", 
  "SELECT *
FROM (VALUES) AS t"],
["select * from emp order by deptno limit 0", 
  "SELECT *
FROM (VALUES) AS t"],
["select name, sum(distinct cn), sum(distinct sm)
from (
  select name, count(dept.deptno) as cn,sum(dept.deptno) as sm
  from sales.dept group by name)
group by name", 
  "SELECT t0.NAME, CAST(SUM(t0.CN) AS BIGINT), CAST(SUM(t0.SM) AS INTEGER)
FROM (SELECT DEPT.NAME, COUNT(*) AS CN, SUM(DEPT.DEPTNO) AS SM
FROM CATALOG.SALES.DEPT AS DEPT
GROUP BY DEPT.NAME) AS t0
GROUP BY t0.NAME"],
["select deptno, count(distinct ename) from sales.emp group by deptno", 
  "SELECT t.EXPR$1 AS DEPTNO, COUNT(t.DEPTNO)
FROM (SELECT EMP.ENAME, EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME, EMP.DEPTNO) AS t
GROUP BY t.EXPR$1"],
["select deptno, count(distinct ename), sum(sal) from sales.emp group by deptno", 
  "SELECT EMP.DEPTNO, COUNT(EMP.ENAME), CAST(MIN(SUM(EMP.SAL)) AS INTEGER)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO"],
["select count(distinct deptno), sum(sal) from sales.emp group by deptno", 
  "SELECT COUNT(EMP.DEPTNO), CAST(MIN(SUM(EMP.SAL)) AS INTEGER)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO"],
["select empno,
  deptno in (select deptno from sales.emp where empno < 20) as d
from sales.emp", 
  "SELECT EMP.EMPNO, CASE WHEN t2.i IS NOT NULL THEN TRUE ELSE FALSE END AS D
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT EMP0.DEPTNO, TRUE AS i
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20
GROUP BY EMP0.DEPTNO, TRUE) AS t2 ON EMP.DEPTNO = t2.DEPTNO"],
["SELECT deptno, ename, CASE WHEN 1=2 THEN substring(ename, 1, cast(2 as int)) ELSE NULL end from emp group by deptno, ename, case when 1=2 then substring(ename,1, cast(2 as int))  else null end", 
  "SELECT EMP.DEPTNO, EMP.ENAME, NULL
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.ENAME, NULL"],
["${sql}", 
  "SELECT t3.DEPTNO, t3.JOB, SUM(COUNT(*))
FROM (SELECT EMP.DEPTNO, EMP.JOB, COUNT(*)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.JOB
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB, COUNT(*)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.DEPTNO, EMP0.JOB) AS t3
GROUP BY t3.DEPTNO, t3.JOB"],
["select emp.empno, count(*), avg(distinct dept.deptno)
from sales.emp emp inner join sales.dept dept
on emp.deptno = dept.deptno
group by emp.empno", 
  "SELECT t0.EMPNO, SUM(t0.EXPR$2), AVG(SUM(t0.EXPR$2))
FROM (SELECT EMP.EMPNO, DEPT.DEPTNO AS DEPTNO0, COUNT(*)
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO
GROUP BY EMP.EMPNO, DEPT.DEPTNO) AS t0
GROUP BY t0.EMPNO"],
["select a.name
from dept a
left join dept b on b.deptno > 10
right join dept c on b.deptno > 10
", 
  "SELECT DEPT.NAME
FROM CATALOG.SALES.DEPT AS DEPT
LEFT JOIN CATALOG.SALES.DEPT AS DEPT0 ON DEPT0.DEPTNO > 10
RIGHT JOIN CATALOG.SALES.DEPT AS DEPT1 ON DEPT0.DEPTNO > 10"],
["select * from emp where deptno = 10
union
select * from emp where deptno = 20
intersect
select * from emp where deptno = 30
", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
UNION
SELECT *
FROM (SELECT *
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO = 20
INTERSECT
SELECT *
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.DEPTNO = 30) AS t2"],
["SELECT deptno,
  SUM(deptno), SUM(DISTINCT sal), MAX(deptno), MAX(comm)
FROM emp
GROUP BY deptno", 
  "SELECT t0.DEPTNO, SUM(t0.EXPR$2), SUM(SUM(t0.EXPR$2)), MAX(MAX(EMP.DEPTNO)), MAX(MAX(EMP.COMM))
FROM (SELECT EMP.DEPTNO, EMP.SAL, SUM(EMP.DEPTNO), MAX(EMP.DEPTNO), MAX(EMP.COMM)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.SAL) AS t0
GROUP BY t0.DEPTNO"],
["SELECT deptno, COUNT(deptno), SUM(DISTINCT sal)
FROM emp
GROUP BY deptno", 
  "SELECT t0.DEPTNO, SUM(t0.EXPR$2), SUM(SUM(t0.EXPR$2))
FROM (SELECT EMP.DEPTNO, EMP.SAL, COUNT(*)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.SAL) AS t0
GROUP BY t0.DEPTNO"],
["select empno from emp
where empno=10 and empno is not null", 
  "SELECT EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.EMPNO = 10"],
["${sql}", 
  "SELECT t3.DEPTNO, t3.JOB, MIN(MIN(EMP0.EMPNO))
FROM (SELECT EMP.DEPTNO, EMP.JOB, MIN(EMP.EMPNO)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.JOB
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB, MIN(EMP0.EMPNO)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.DEPTNO, EMP0.JOB) AS t3
GROUP BY t3.DEPTNO, t3.JOB"],
["${sql}", 
  "SELECT 4, 2 + 3, MAX(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY 4"],
["${sql}", 
  "SELECT EMP.DEPTNO, MAX(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.DEPTNO + 42"],
["select * from (values (30, 3))intersect
select *
from (values (10, 1), (30, 3)) as t (x, y) where x > 50
intersect
select * from (values (30, 3))", 
  "SELECT *
FROM (VALUES) AS t"],
["select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from bonus b right outer join emp e on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end", 
  "SELECT COUNT(*), t0.CASE
FROM (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t
RIGHT JOIN (SELECT EMP.ENAME, CASE WHEN EMP.SAL < 11 THEN 11 ELSE -1 * EMP.SAL END AS CASE
FROM CATALOG.SALES.EMP AS EMP) AS t0 ON t.ENAME = t0.ENAME
GROUP BY t0.CASE"],
["select empno
from sales.emp left join sales.dept
on exists (select deptno from sales.emp where empno < 20)", 
  "SELECT EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (CATALOG.SALES.DEPT AS DEPT,
(SELECT TRUE AS i
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20
GROUP BY TRUE) AS t1) ON TRUE"],
["select *
from emp
where (empno, deptno) in (
  select empno, deptno from (
    select empno, deptno
    from emp
    group by empno, deptno))
or deptno < 40 + 60", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE (EMP.EMPNO, EMP.DEPTNO) IN (SELECT EMP0.EMPNO, EMP0.DEPTNO
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.EMPNO, EMP0.DEPTNO) OR EMP.DEPTNO < 100"],
["select * from emp where deptno = 10
intersect
select * from emp where deptno = 20
intersect
select * from emp where deptno = 30
", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
INTERSECT
SELECT *
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO = 20
INTERSECT
SELECT *
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.DEPTNO = 30"],
["${sql}", 
  "SELECT t3.ENAME, SUM(SUM(3))
FROM (SELECT EMP.ENAME, SUM(2)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME
UNION ALL
SELECT EMP0.ENAME, SUM(3)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.ENAME) AS t3
GROUP BY t3.ENAME"],
["select 1 from emp inner join dept on emp.deptno = dept.deptno", 
  "SELECT 1
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO
INNER JOIN CATALOG.SALES.DEPT AS DEPT0 ON EMP.DEPTNO = DEPT0.DEPTNO"],
["select empno,
  exists (select deptno from sales.emp where empno < 20) as d
from sales.emp", 
  "SELECT EMP.EMPNO, CASE WHEN t1.i IS NOT NULL THEN TRUE ELSE FALSE END AS D
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT TRUE AS i
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20
GROUP BY TRUE) AS t1 ON TRUE"],
["select e.ename from emp e, dept d where e.deptno = d.deptno and e.ename = 'foo'", 
  "SELECT t.ENAME
FROM (SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.ENAME = 'foo') AS t
INNER JOIN CATALOG.SALES.DEPT AS DEPT ON t.DEPTNO = DEPT.DEPTNO"],
["select 1 from sales.dept d right outer join sales.emp e on d.deptno = e.deptno where d.name = 'Charlie'", 
  "SELECT 1
FROM (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
WHERE DEPT.NAME = 'Charlie') AS t
INNER JOIN CATALOG.SALES.EMP AS EMP ON t.DEPTNO = EMP.DEPTNO"],
["select deptno, count(distinct deptno, job) as cddj, sum(sal) as s
 from sales.emp group by deptno", 
  "SELECT EMP.DEPTNO, COUNT(EMP.DEPTNO, EMP.JOB) AS CDDJ, CAST(MIN(SUM(EMP.SAL)) AS INTEGER) AS S
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO"],
["select d.deptno, e.deptno from sales.dept d, sales.emp e where d.deptno + 10 = e.deptno * 2", 
  "SELECT t.DEPTNO, t0.DEPTNO AS DEPTNO0
FROM (SELECT DEPT.DEPTNO, DEPT.NAME, DEPT.DEPTNO + 10 AS $f2
FROM CATALOG.SALES.DEPT AS DEPT) AS t
INNER JOIN (SELECT EMP.EMPNO, EMP.ENAME, EMP.JOB, EMP.MGR, EMP.HIREDATE, EMP.SAL, EMP.COMM, EMP.DEPTNO, EMP.SLACKER, EMP.DEPTNO * 2 AS $f9
FROM CATALOG.SALES.EMP AS EMP) AS t0 ON t.$f2 = t0.$f9"],
["select e1.ename from emp e1, dept d, emp e2 where e1.deptno = d.deptno and d.deptno = e2.deptno and d.name = 'foo'", 
  "SELECT EMP.ENAME
FROM CATALOG.SALES.EMP AS EMP
INNER JOIN (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
WHERE DEPT.NAME = 'foo') AS t ON EMP.DEPTNO = t.DEPTNO
INNER JOIN CATALOG.SALES.EMP AS EMP0 ON t.DEPTNO = EMP0.DEPTNO"],
["select 1 from sales.dept d full outer join sales.emp e on d.deptno = e.deptno where d.name = 'Charlie'", 
  "SELECT 1
FROM (SELECT *
FROM CATALOG.SALES.DEPT AS DEPT
WHERE DEPT.NAME = 'Charlie') AS t
LEFT JOIN CATALOG.SALES.EMP AS EMP ON t.DEPTNO = EMP.DEPTNO"],
["${sql}", 
  "SELECT EMP.DEPTNO, MAX(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO"],
["select count(1) from emp
where case deptno
  when 20 then 2
  when 10 then 1
  else cast(null as integer) end = 1", 
  "SELECT COUNT(*)
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10"],
["select count(1) from emp
where case deptno
  when 30 then 1
  when 20 then 2
  when 10 then 1
  when 30 then 111
  else 0 end = 1", 
  "SELECT COUNT(*)
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 30 OR EMP.DEPTNO = 10"],
["select empno
from sales.emp left join sales.dept
on (select deptno from sales.emp where empno < 20)
 < (select deptno from sales.emp where empno > 100)", 
  "SELECT EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (CATALOG.SALES.DEPT AS DEPT
LEFT JOIN (SELECT SINGLE_VALUE(EMP0.DEPTNO) AS $f0
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20) AS t1 ON TRUE
LEFT JOIN (SELECT SINGLE_VALUE(EMP1.DEPTNO) AS $f0
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.EMPNO > 100) AS t4 ON TRUE) ON t1.$f0 < t4.$f0"],
["${sql}", 
  "SELECT 4, 2 + 3, MAX(5)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY 4"],
["select 1 from sales.dept d left outer join sales.emp e on d.deptno = e.deptno", 
  "SELECT 1
FROM CATALOG.SALES.EMP AS EMP
RIGHT JOIN CATALOG.SALES.DEPT AS DEPT ON EMP.DEPTNO = DEPT.DEPTNO"],
["select r1.sal from (select * from emp e1 union all select * from emp e2) r1, emp r2", 
  "SELECT t.SAL
FROM (SELECT *
FROM CATALOG.SALES.EMP AS EMP,
CATALOG.SALES.EMP AS EMP0
UNION ALL
SELECT *
FROM CATALOG.SALES.EMP AS EMP1,
CATALOG.SALES.EMP AS EMP2) AS t"],
["select * from emp where deptno = 10
union all
select * from emp where deptno = 20
union
select * from emp where deptno = 30
", 
  "SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
UNION
SELECT *
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO = 20
UNION
SELECT *
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.DEPTNO = 30"],
["select deptno from emp
group by deptno having count(*) > 1", 
  "SELECT EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO
HAVING COUNT(*) > 1"],
["select * from (values (1,2)) where 1 + 2 > 3 + CAST(NULL AS INTEGER)", 
  "SELECT *
FROM (VALUES) AS t"],
["select empno
from sales.emp
where exists (select deptno from sales.emp where empno < 20)
or emp.sal < 100", 
  "SELECT EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT TRUE AS i
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20
GROUP BY TRUE) AS t1 ON TRUE
WHERE t1.i IS NOT NULL OR EMP.SAL < 100"],
["select job, empno, sal, sum(sal) as s
from emp where empno = 10
group by job, empno, sal", 
  "SELECT EMP.JOB, 10 AS EMPNO, EMP.SAL, SUM(EMP.SAL) AS S
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.EMPNO = 10
GROUP BY EMP.JOB, EMP.SAL"],
["select count(*)
from emp
where case when mgr < 10 then true else false end", 
  "SELECT COUNT(*)
FROM (SELECT EMP.MGR
FROM CATALOG.SALES.EMP AS EMP) AS t
WHERE t.MGR < 10"],
["select e1.sal
from (select * from emp where deptno = 200) as e1
where e1.deptno in (
  select e2.deptno from emp e2 where e2.sal = 100)", 
  "SELECT t0.SAL
FROM (SELECT *
FROM (SELECT EMP.SAL, EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP) AS t
WHERE t.DEPTNO = 200) AS t0
INNER JOIN (SELECT t2.DEPTNO
FROM (SELECT EMP0.SAL, EMP0.DEPTNO
FROM CATALOG.SALES.EMP AS EMP0) AS t1
WHERE t1.SAL = 100) AS t3 ON t0.DEPTNO = t3.DEPTNO"],
["select empno,
  (select deptno from sales.emp where empno < 20) as d
from sales.emp", 
  "SELECT EMP.EMPNO, t1.$f0 AS D
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT SINGLE_VALUE(EMP0.DEPTNO) AS $f0
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20) AS t1 ON TRUE"],
["select count(distinct ename), count(distinct job)
 from sales.emp", 
  "SELECT COUNT(EMP.ENAME), COUNT(EMP.JOB)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME, EMP.JOB"],
["with e2 as (
  select empno, case when true then deptno else null end as deptno
  from sales.emp)
select empno,
  deptno in (select deptno from e2 where empno < 20) as d
from e2", 
  "SELECT t.EMPNO, CASE WHEN t3.c = 0 THEN FALSE WHEN t8.i IS NOT NULL THEN TRUE WHEN t.DEPTNO IS NULL THEN NULL WHEN t3.ck < t3.c THEN NULL ELSE FALSE END AS D
FROM (SELECT EMP.EMPNO, CASE WHEN TRUE THEN CAST(EMP.DEPTNO AS INTEGER) ELSE NULL END AS DEPTNO
FROM CATALOG.SALES.EMP AS EMP) AS t,
(SELECT COUNT(*) AS c, COUNT(t1.DEPTNO) AS ck
FROM (SELECT EMP0.EMPNO, CASE WHEN TRUE THEN CAST(EMP0.DEPTNO AS INTEGER) ELSE NULL END AS DEPTNO
FROM CATALOG.SALES.EMP AS EMP0) AS t0
WHERE t0.EMPNO < 20) AS t3
LEFT JOIN (SELECT t5.DEPTNO, TRUE AS i
FROM (SELECT EMP1.EMPNO, CASE WHEN TRUE THEN CAST(EMP1.DEPTNO AS INTEGER) ELSE NULL END AS DEPTNO
FROM CATALOG.SALES.EMP AS EMP1) AS t4
WHERE t4.EMPNO < 20
GROUP BY t5.DEPTNO, TRUE) AS t8 ON t.DEPTNO = t8.DEPTNO"],
["select ename, sal, deptno from (  select ename, sal, deptno  from emp  where sal > 5000)group by ename, sal, deptno", 
  "SELECT EMP.ENAME, EMP.SAL, EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME, EMP.SAL, EMP.DEPTNO
HAVING EMP.SAL > 5000"],
["select count(*) as c
from sales.emp
where deptno = 10
group by deptno", 
  "SELECT COUNT(*) AS C
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
GROUP BY EMP.DEPTNO"],
["select job
from sales.emp
where sal is null and job = 'Clerk'
group by sal, job
having count(*) > 3", 
  "SELECT t3.JOB
FROM (SELECT EMP.SAL, 'Clerk' AS JOB, COUNT(*) AS $f2
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.SAL IS NULL AND EMP.JOB = 'Clerk'
GROUP BY EMP.SAL) AS t2
WHERE t2.$f2 > 3"],
["select count(*), case when e.sal < 11 then -1 * e.sal else e.sal end
from emp e inner join bonus b on e.ename = b.ename
group by case when e.sal < 11 then -1 * e.sal else e.sal end", 
  "SELECT COUNT(*), t.CASE
FROM (SELECT EMP.ENAME, CASE WHEN EMP.SAL < 11 THEN -1 * EMP.SAL ELSE EMP.SAL END AS CASE
FROM CATALOG.SALES.EMP AS EMP) AS t
INNER JOIN (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t0 ON t.ENAME = t0.ENAME
GROUP BY t.CASE"],
["select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from bonus b left outer join emp e on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end", 
  "SELECT COUNT(*), CASE WHEN t0.< THEN 11 ELSE t0.* END
FROM (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t
LEFT JOIN (SELECT EMP.ENAME, EMP.SAL < 11 AS <, -1 * EMP.SAL AS *
FROM CATALOG.SALES.EMP AS EMP) AS t0 ON t.ENAME = t0.ENAME
GROUP BY CASE WHEN t0.< THEN 11 ELSE t0.* END"],
["select dept.* from dept full join (
  select distinct deptno from emp
  where sal > 100) using (deptno)", 
  "SELECT DEPT.DEPTNO, DEPT.NAME
FROM CATALOG.SALES.DEPT AS DEPT
FULL JOIN (SELECT EMP.DEPTNO
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.SAL > 100
GROUP BY EMP.DEPTNO) AS t1 ON DEPT.DEPTNO = t1.DEPTNO"],
["select name from dept left join (
  select distinct deptno from emp
  where sal > 100) using (deptno)", 
  "SELECT DEPT.NAME
FROM CATALOG.SALES.DEPT AS DEPT"],
["select empno, (empno, deptno) in (
    select empno, deptno from sales.emp where empno < 20) as d
from sales.emp", 
  "SELECT EMP.EMPNO, CASE WHEN t1.i IS NOT NULL THEN TRUE ELSE FALSE END AS D
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT EMP0.EMPNO, EMP0.DEPTNO, TRUE AS i
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20) AS t1 ON EMP.EMPNO = t1.EMPNO AND EMP.DEPTNO = t1.DEPTNO"],
["select * from (
select * from emp where false)
left join dept using (deptno)", 
  "SELECT *
FROM (VALUES) AS t"],

[CALCITE-1045]
["select sal
from emp
where case when (sal = 1000) then
(case when sal = 1000 then null else 1 end is null) else
(case when sal = 2000 then null else 1 end is null) end is true", 
  "SELECT EMP.SAL
FROM CATALOG.SALES.EMP AS EMP
WHERE CASE WHEN EMP.SAL = 1000 THEN EMP.SAL = 1000 ELSE EMP.SAL = 2000 END"],
["select deptno, count(distinct ename) as cde,
  count(distinct job, ename) as cdje,
  count(distinct deptno, job) as cddj,
  sum(sal) as s
 from sales.emp group by deptno", 
  "SELECT EMP.DEPTNO, COUNT(EMP.ENAME) AS CDE, COUNT(EMP.JOB, EMP.ENAME) AS CDJE, COUNT(EMP.DEPTNO, EMP.JOB) AS CDDJ, CAST(MIN(SUM(EMP.SAL)) AS INTEGER) AS S
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO"],
["${sql}", 
  "SELECT t3.DEPTNO, t3.JOB, SUM(SUM(NULL))
FROM (SELECT EMP.DEPTNO, EMP.JOB, SUM(NULL)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.DEPTNO, EMP.JOB
UNION ALL
SELECT EMP0.DEPTNO, EMP0.JOB, SUM(NULL)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.DEPTNO, EMP0.JOB) AS t3
GROUP BY t3.DEPTNO, t3.JOB"],
["select empno
from sales.emp
where empno
 < case deptno in (select case when true then deptno else null end
                   from sales.emp where empno < 20)
   when true then 10
   when false then 20
   else 30
   end", 
  "SELECT EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP,
(SELECT COUNT(*) AS c, COUNT(CASE WHEN TRUE THEN CAST(EMP0.DEPTNO AS INTEGER) ELSE NULL END) AS ck
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20) AS t1
LEFT JOIN (SELECT CASE WHEN TRUE THEN CAST(EMP1.DEPTNO AS INTEGER) ELSE NULL END, TRUE AS i
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.EMPNO < 20
GROUP BY CASE WHEN TRUE THEN CAST(EMP1.DEPTNO AS INTEGER) ELSE NULL END, TRUE) AS t5 ON EMP.DEPTNO = CASE WHEN TRUE THEN CAST(EMP1.DEPTNO AS INTEGER) ELSE NULL END
WHERE EMP.EMPNO < CASE WHEN CASE WHEN t1.c = 0 THEN FALSE WHEN t5.i IS NOT NULL THEN TRUE WHEN t1.ck < t1.c THEN NULL ELSE FALSE END = TRUE THEN 10 WHEN CASE WHEN t1.c = 0 THEN FALSE WHEN t5.i IS NOT NULL THEN TRUE WHEN t1.ck < t1.c THEN NULL ELSE FALSE END = FALSE THEN 20 ELSE 30 END"],
["select a.name from dept a
union all
select b.name from dept b
order by name", 
  "SELECT *
FROM (SELECT DEPT.NAME
FROM CATALOG.SALES.DEPT AS DEPT
ORDER BY DEPT.NAME
UNION ALL
SELECT DEPT0.NAME
FROM CATALOG.SALES.DEPT AS DEPT0
ORDER BY DEPT0.NAME) AS t3
ORDER BY t3.NAME"],
["select a.name from dept a
union all
select b.name from dept b
order by name limit 0", 
  "SELECT *
FROM (SELECT DEPT.NAME
FROM CATALOG.SALES.DEPT AS DEPT
ORDER BY DEPT.NAME
FETCH NEXT 0 ROWS ONLY
UNION ALL
SELECT DEPT0.NAME
FROM CATALOG.SALES.DEPT AS DEPT0
ORDER BY DEPT0.NAME
FETCH NEXT 0 ROWS ONLY) AS t5
ORDER BY t5.NAME
FETCH NEXT 0 ROWS ONLY"],
["select empno
from sales.emp
where (select deptno from sales.emp where empno < 20)
 < (select deptno from sales.emp where empno > 100)
or emp.sal < 100", 
  "SELECT EMP.EMPNO
FROM CATALOG.SALES.EMP AS EMP
LEFT JOIN (SELECT SINGLE_VALUE(EMP0.DEPTNO) AS $f0
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.EMPNO < 20) AS t1 ON TRUE
LEFT JOIN (SELECT SINGLE_VALUE(EMP1.DEPTNO) AS $f0
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.EMPNO > 100) AS t4 ON TRUE
WHERE t1.$f0 < t4.$f0 OR EMP.SAL < 100"],
["select * from (values (1,2)) where false", 
  "SELECT *
FROM (VALUES) AS t"],
["${sql}", 
  "SELECT t3.ENAME, MAX(MAX(EMP0.MGR))
FROM (SELECT EMP.ENAME, MAX(EMP.MGR)
FROM CATALOG.SALES.EMP AS EMP
GROUP BY EMP.ENAME
UNION ALL
SELECT EMP0.ENAME, MAX(EMP0.MGR)
FROM CATALOG.SALES.EMP AS EMP0
GROUP BY EMP0.ENAME) AS t3
GROUP BY t3.ENAME"],
["select 2, deptno, job from emp as e1
union all
select 1, deptno, job from emp as e2", 
  "SELECT 2, EMP.DEPTNO, EMP.JOB
FROM CATALOG.SALES.EMP AS EMP
UNION ALL
SELECT 1, EMP0.DEPTNO, EMP0.JOB
FROM CATALOG.SALES.EMP AS EMP0"],
["select 2, 3 from emp as e1
union all
select 2, 3 from emp as e2", 
  "SELECT 2, 3
FROM (SELECT 2
FROM CATALOG.SALES.EMP AS EMP
UNION ALL
SELECT 2
FROM CATALOG.SALES.EMP AS EMP0) AS t1"],
["select count(*), case when e.sal < 11 then 11 else -1 * e.sal end
from emp e right outer join bonus b on e.ename = b.ename
group by case when e.sal < 11 then 11 else -1 * e.sal end", 
  "SELECT COUNT(*), CASE WHEN t.< THEN 11 ELSE t.* END
FROM (SELECT EMP.ENAME, EMP.SAL < 11 AS <, -1 * EMP.SAL AS *
FROM CATALOG.SALES.EMP AS EMP) AS t
RIGHT JOIN (SELECT BONUS.ENAME
FROM CATALOG.SALES.BONUS AS BONUS) AS t0 ON t.ENAME = t0.ENAME
GROUP BY CASE WHEN t.< THEN 11 ELSE t.* END"],
["select * from emp where deptno = 10
union
select * from emp where deptno = 20
union all
select * from emp where deptno = 30
", 
  "SELECT *
FROM (SELECT *
FROM CATALOG.SALES.EMP AS EMP
WHERE EMP.DEPTNO = 10
UNION
SELECT *
FROM CATALOG.SALES.EMP AS EMP0
WHERE EMP0.DEPTNO = 20) AS t1
UNION ALL
SELECT *
FROM CATALOG.SALES.EMP AS EMP1
WHERE EMP1.DEPTNO = 30"]
]
